<div class="p-2 p-lg-4">
  <div class="d-flex justify-content-between align-items-center">
    <div>
      <input type="text" placeholder="Chercher" [(ngModel)]="search" (ngModelChange)="searchSubject.next($event)" class="form-control" id="searchProd">
    </div>

    <app-invoice-create
      [reference]="reference"
      [publicId]="publicId"
      (createDraft)="createDraftInvoice()"
      (refresh)="refresh()"
      class="ms-auto">
    </app-invoice-create>
  </div>
  <div class="mt-3">
    <app-invoice-update
      [show]="showUpdate"
      [savedInvoice]="invoiceToUpdate"
      [readOnly]="readOnly"
      (refresh)="refresh()"
      class="ms-auto">
    </app-invoice-update>
    <table *ngIf="invoices | async as invoiceData" class="table">
      <thead>
      <tr>
        <th scope="col">Réference</th>
        <th scope="col">Date</th>
        <th scope="col">Client</th>
        <th scope="col">Actions</th>
      </tr>
      </thead>
      <tbody *ngIf="invoiceCount > 0">
      <tr *ngFor="let item of invoiceData">
        <td>{{item.reference}}</td>
        <td>{{item.creationDate | date: 'dd/MM/yyyy'}}</td>
        <td>{{item.client.name}}</td>
        <td>
          <i *ngIf="!item.closed" (click)="update(item)" class="bi bi-pencil-square h4 me-2"></i>
          <i *ngIf="item.closed" (click)="readOnlyMode(item)"class="bi bi-bag-check-fill h4 me-2"></i>
          <i *ngIf="!item.closed" (click)="closeComponent?.openCloseModal(item)" class="bi bi-database-check h4 ms-2"></i>
          <i *ngIf="item.closed" (click)="export(item)" class="bi bi-cloud-download h4 ms-2"></i>
        </td>
      </tr>
      </tbody>
    </table>
    <app-placeholder [isLoading]="isLoading"></app-placeholder>
    <app-pagination [count]="invoiceCount" (selectPage)="changePage($event)"></app-pagination>
    <app-close (validClose)="validClose($event)"></app-close>
    <h6 class="d-flex mt-5 justify-content-center" *ngIf="invoiceCount === 0 && !isLoading">Aucune facture trouvée</h6>
  </div>
</div>
